## **Part B: SQL Queries Using Joins**

| No. | Question |
|-----|----------|
| 1 | Find Loan_nos where loans are taken from branches in MUMBAI. |
| 2 | Find account types in branches located in DELHI. |
| 3 | Find names and phone numbers of customers with account balance > 100000. |
| 4 | Find installment_no and amount for customer 'RAJ ANAND SINGH'. |
| 5 | Find names of customers without any SB account. |
| 6 | Find names of customers who paid installment of 50000. |
| 7 | Find phone numbers of customers with account at SALTLAKE branch. |
| 8 | Find Branch_name and Branch_city of customer 'ABHIJIT MISHRA'. |
| 9 | Find account types and balances of 'SWAROOP RAY'. |
| 10 | Find branch codes where total balance > average of all branches. |

### **Solutions**
```sql
-- 1
SELECT LOAN_NO FROM LOAN L
JOIN BRANCH B ON L.BRANCH_CODE = B.BRANCH_CODE
WHERE B.BRANCH_CITY = 'MUMBAI';

-- 2
SELECT DISTINCT A.TYPE FROM ACCOUNT A
JOIN BRANCH B ON A.BRANCH_CODE = B.BRANCH_CODE
WHERE B.BRANCH_CITY = 'DELHI';

-- 3
SELECT DISTINCT C.NAME, C.PHONE_NO FROM CUSTOMER C
JOIN DEPOSITOR D ON C.CUST_NO = D.CUST_NO
JOIN ACCOUNT A ON D.ACCOUNT_NO = A.ACCOUNT_NO
WHERE A.BALANCE > 100000;

-- 4
SELECT I.INST_NO, I.INST_AMOUNT FROM INSTALLMENT I
JOIN LOAN L ON I.LOAN_NO = L.LOAN_NO
JOIN CUSTOMER C ON L.CUST_NO = C.CUST_NO
WHERE C.NAME = 'RAJ ANAND SINGH';

-- 5
SELECT DISTINCT C.NAME FROM CUSTOMER C
WHERE C.CUST_NO NOT IN (
    SELECT D.CUST_NO FROM DEPOSITOR D
    JOIN ACCOUNT A ON D.ACCOUNT_NO = A.ACCOUNT_NO
    WHERE A.TYPE = 'SB'
);

-- 6
SELECT DISTINCT C.NAME FROM CUSTOMER C
JOIN LOAN L ON C.CUST_NO = L.CUST_NO
JOIN INSTALLMENT I ON L.LOAN_NO = I.LOAN_NO
WHERE I.INST_AMOUNT = 50000;

-- 7
SELECT DISTINCT C.PHONE_NO FROM CUSTOMER C
JOIN DEPOSITOR D ON C.CUST_NO = D.CUST_NO
JOIN ACCOUNT A ON D.ACCOUNT_NO = A.ACCOUNT_NO
JOIN BRANCH B ON A.BRANCH_CODE = B.BRANCH_CODE
WHERE B.BRANCH_NAME = 'SALTLAKE BRANCH';

-- 8
SELECT DISTINCT B.BRANCH_NAME, B.BRANCH_CITY FROM BRANCH B
JOIN ACCOUNT A ON B.BRANCH_CODE = A.BRANCH_CODE
JOIN DEPOSITOR D ON A.ACCOUNT_NO = D.ACCOUNT_NO
JOIN CUSTOMER C ON D.CUST_NO = C.CUST_NO
WHERE C.NAME = 'ABHIJIT MISHRA';

-- 9
SELECT A.TYPE, A.BALANCE FROM ACCOUNT A
JOIN DEPOSITOR D ON A.ACCOUNT_NO = D.ACCOUNT_NO
JOIN CUSTOMER C ON D.CUST_NO = C.CUST_NO
WHERE C.NAME = 'SWAROOP RAY';

-- 10
WITH BRANCH_BALANCE AS (
    SELECT BRANCH_CODE, SUM(BALANCE) AS TOTAL_BAL
    FROM ACCOUNT GROUP BY BRANCH_CODE
),
AVG_BAL AS (
    SELECT AVG(TOTAL_BAL) AS AVG_BALANCE FROM BRANCH_BALANCE
)
SELECT BRANCH_CODE FROM BRANCH_BALANCE
WHERE TOTAL_BAL > (SELECT AVG_BALANCE FROM AVG_BAL);
```

---

## **End of Assignment**
